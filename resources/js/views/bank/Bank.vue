<template>
    <div id="bank">
        <!--        <Loader v-if="loading"/>-->

        <b-modal id="modal-how-invest" header-bg-variant="info" hide-footer>
            <h3>–ê –∫–∞–∫ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?</h3>
            <span class="my-2">
               <span>
                   –í —Ä–∞–∑–¥–µ–ª–µ "–û–±–º–µ–Ω –≤–∞–ª—é—Ç" –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –≤–∞—à–∏–º–∏ —Å—á–µ—Ç–∞–º–∏. <br>
                    –í –∏–≥—Ä–µ –µ—Å—Ç—å 4 –≤–∞–ª—é—Ç—ã: <ul>
                        <li><i>–ì—É—Å—Ç–∏–Ω–∏–∞–Ω—ã <b>(GTN)</b></i> - –ø–æ–∫—É–ø–∞—é—Ç—Å—è –∑–∞ –¥–æ–Ω–∞—Ç</li>
                        <li><i>–†—É–±–ª—å <b>(RUB)</b></i></li>
                        <li><i>–î–æ–ª–ª–∞—Ä <b>(USD)</b></i></li>
                        <li><i>–ë–∏—Ç–∫–æ–∏–Ω <b>(BTC)</b></i></li>
                    </ul>
                    <br>
                    –ì—É—Å—Ç–∏–Ω–∏–∞–Ω—ã - —ç—Ç–æ —ç–ª–∏—Ç–Ω–∞—è –≤–∞–ª—é—Ç–∞, –∑–∞ –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å —Ç–æ, —á—Ç–æ –Ω–µ–ª—å–∑—è –∑–∞ –¥—Ä—É–≥–∏–µ –≤–∞–ª—é—Ç—ã.
                    –û–Ω–∏ –ø–æ–∫—É–ø–∞—é—Ç—Å—è –∑–∞ –¥–æ–Ω–∞—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ "–ö—É–ø–∏—Ç—å –≥—É—Å—Ç–∏–Ω–∏–∞–Ω—ã (GTN)". <br>
               </span>

                <h4>–ü–µ—Ä–µ–π–¥–µ–º –∫ —Ä–∞–∑–±–æ—Ä—É —Ä–∞–∑–¥–µ–ª–∞ "–û–±–º–µ–Ω –≤–∞–ª—é—Ç"</h4>
                <p>
                    –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ–º —Ç–∏–ø —Å–¥–µ–ª–∫–∏: –∫—É–ø–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–¥–∞—Ç—å. <br>
                    –ó–∞—Ç–µ–º –≤—ã–±–∏—Ä–∞–µ–º –∫–∞–∫—É—é –≤–∞–ª—é—Ç—É –º—ã —Ö–æ—Ç–∏–º –∫—É–ø–∏—Ç—å/–ø—Ä–æ–¥–∞—Ç—å. <br>
                    –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –ø–æ–ª–µ –≤–≤–æ–¥–∏–º —Å—É–º–º—É –∫–æ—Ç–æ—Ä—É—é –º—ã —Ö–æ—Ç–∏–º –æ–±–º–µ–Ω—è—Ç—å/–ø—Ä–æ–¥–∞—Ç—å.
                    –í –ø–æ–ª–µ –Ω–∏–∂–µ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∞ —Å—É–º–º–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–æ–ª—É—á–∏–º –ø—Ä–∏ –æ–±–º–µ–Ω–µ/–ø—Ä–æ–¥–∞–∂–∏. <br>
                    –ß—Ç–æ–±—ã —Å–æ–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –Ω–∞–∂–∏–º–∞–µ–º –Ω–∞ –∫–Ω–æ–ø–∫—É –∫—É–ø–∏—Ç—å/–ø—Ä–æ–¥–∞—Ç—å.
                </p>
                <hr>

                <h4>–ö–∞–∫ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö?</h4>
                <span>
                    –ü—Ä–∏ –æ–±–º–µ–Ω–µ –≤–∞–ª—é—Ç –º–æ–∂–Ω–æ —Ö–æ—Ä–æ—à–æ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º 2 —Å–∏—Ç—É–∞—Ü–∏–∏: <br>

                    <p>
                        <b>USD –∏–ª–∏ BTC</b> - –∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞ –∏ –±–∏—Ç–∫–æ–∏–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ç–æ —Ä–∞—Å—Ç–µ—Ç, —Ç–æ –ø–∞–¥–∞–µ—Ç.
                        –ß—Ç–æ–±—ã –Ω–∞ —ç—Ç–æ–º –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å, –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å —Å–∞–º–æ–≥–æ –Ω–∏–∑–∫–æ–≥–æ –∫—É—Ä—Å–∞, —á—Ç–æ–±—ã –∫—É–ø–∏—Ç—å –≤–∞–ª—é—Ç—É.
                        –ê –ø–æ—Ç–æ–º –∂–¥–∞—Ç—å –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∫—É—Ä—Å–∞, —á—Ç–æ–±—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤—ã–≥–æ–¥–Ω–æ –ø—Ä–æ–¥–∞—Ç—å –µ—ë.
                        <b>–ü—Ä–∏–º–µ—Ä:</b> –£ –º–∞—à–∏ –±—ã–ª–æ 10–∫ —Ä—É–±–ª–µ–π. –û–Ω–∞ –∫—É–ø–∏–ª–∞ –Ω–∞ –Ω–∏—Ö 0,00359 BTC.
                        –ê —á–µ—Ä–µ–∑ 2 –¥–Ω—è –∫—É—Ä—Å –±–∏—Ç–∫–æ–∏–Ω–∞ —É–≤–µ–ª–∏—á–∏–ª—Å—è. –ò —É –ú–∞—à–∏ 0,00359 BTC —Å—Ç–∞–ª–∏ —Å—Ç–æ–∏—Ç—å –Ω–µ 10–∫,
                        –∞ 19–∫ —Ä—É–±–ª–µ–π.
                    </p>

                    <p>
                        <b>–ü—Ä–æ–¥–∞–∂–∞ GTN</b> - –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±–º–µ–Ω—è—Ç—å –ª–∏—à–Ω–∏–µ –≥—É—Å—Ç–∏–Ω–∏–∞–Ω—ã –Ω–∞ —Ä—É–±–ª–∏, —Ç–æ
                        –ø–æ–¥–æ–∂–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—à–µ–≥–æ –∫—É—Ä—Å–∞, –∫–æ–≥–¥–∞ 1 GTN –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å –º–∞–∫—Å–∏–º—É–º —Ä—É–±–ª–µ–π (–∫—É—Ä—Å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å).
                        –ß—Ç–æ–±—ã –±—ã–ª–æ –ø—Ä–æ—â–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è - —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫. (–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                        –≤ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É—Ä—Å RUB –∫ GTN, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å —Å–∞–º–æ–≥–æ –Ω–∏–∑–∫–æ–≥–æ –∫—É—Ä—Å–∞, —á—Ç–æ–±—ã
                        –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ RUB –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ GTN).
                    </p>
                </span>
            </span>
        </b-modal>

        <b-card>
            <h2>üè¶–ë–∞–Ω–∫</h2>
            <p>
                –≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π –±–∞–Ω–∫ –ì—É—Å—Ç–æ–≥—Ä–∞–¥–∞. –í –Ω—ë–º –≤—ã –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å
                <b>üí∂–≥—É—Å—Ç–∏–Ω–∞–Ω—ãüí∂</b>, –æ–±–º–µ–Ω—è—Ç—å –∏—Ö –Ω–∞ –æ–±—ã—á–Ω—ã–µ –¥–µ–Ω—å–≥–∏ –∏,
                –∫–æ–Ω–µ—á–Ω–æ, –≤–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç –ø–æ–¥ –±–µ—à–µ–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã!
            </p>

            <!--      BALANCE      -->
            <BalanceWidget currency="GTN" :count="getUserWallets.GTN"/>
            <!--      BALANCE      -->

            <hr>

            <!--     WALLETS     -->
            <b-alert show variant="secondary">
                <div id="wallets">
                    <h5>üëõ–í–∞—à–∏ —Å—á–µ—Ç–∞</h5>

                    <div class="container" v-if="Object.values(getCurrencies).length">
                        <!--             GTN           -->
                        <Wallet
                            currency="GTN"
                            :count="getUserWallets.GTN"
                            :rate="getCurrencies.RUB[0].rate"
                            exchange="RUB"
                        />

                        <!--             BTC           -->
                        <Wallet
                            currency="BTC"
                            :count="getUserWallets.BTC"
                            :rate="getCurrencies.BTC[0].rate"
                            exchange="RUB"
                        />

                        <!--             BTC           -->
                        <Wallet
                            currency="USD"
                            :count="getUserWallets.USD"
                            :rate="getCurrencies.USD[0].rate"
                            exchange="RUB"
                        />
                    </div>
                </div>
            </b-alert>
            <!--      WALLETS      -->

            <hr>

            <!--     CREDIT     -->
            <b-alert show variant="danger">
                <div id="credit">
                    <h5>üí∏–í–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)</h5>
                    <label for="credit_sum">–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ –≤ <b>—Ä—É–±–ª—è—Ö RUB</b>:</label>
                    <b-form-input type="number" id="credit_sum" name="credit_sum"></b-form-input>

                    <span>–ù—É–∂–Ω–æ –≤—ã–ø–ª–∞—Ç–∏—Ç—å —Å —É—á–µ—Ç–æ–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤: <b>200 —Ä—É–±–ª–µ–π RUB</b></span>
                </div>
            </b-alert>

            <!--      EXCHANGE GTN      -->
            <b-alert show variant="primary">
                <div id="exchange_currency" class="position-relative">
                    <div class="m-1 position-absolute w-100 text-right">
                        <b-badge
                            v-b-toggle.collapse-shovel
                            pill size="sm"
                            variant="dark"
                            @click="()=>{$bvModal.show('modal-how-invest')}"
                        >?</b-badge>
                    </div>

                    <h5>üí±–û–±–º–µ–Ω –≤–∞–ª—é—Ç</h5>

                    <!--          TRANSACTION TYPE          -->
                    <b-form-group label="–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–¥–µ–ª–∫–∏:" v-slot="{ ariaDescribedby }">
                        <b-form-radio-group
                            id="btn-radios-1"
                            class="w-100"
                            button-variant="primary"
                            v-model="transactionType"
                            :options="transactionOptions"
                            :aria-describedby="ariaDescribedby"
                            name="radios-btn-default"
                            buttons
                        ></b-form-radio-group>
                    </b-form-group>
                    <!--          TRANSACTION TYPE          -->

                    <!--          SELECT CURRENCY          -->
                    <div class="mt-2" v-if="getCurrencies.RUB">
                        <b-tabs
                            active-nav-item-class="text-light bg-primary border-primary"
                            nav-class="border-primary"
                            active-tab-class="border-primary"
                            content-class="mt-2"
                            lazy
                        >
                            <!--   GTN can't buy (RUB can't sell to GTN)   -->
                            <CurrencyTab
                                v-if="transactionType !== 'sell'"
                                :currencies="getCurrencies.RUB"
                                :type="transactionType"
                            />

                            <CurrencyTab :currencies="getCurrencies.USD" :type="transactionType"/>

                            <CurrencyTab :currencies="getCurrencies.BTC" :type="transactionType"/>
                        </b-tabs>
                    </div>
                </div>
            </b-alert>

            <!--      BUY GTN      -->
            <b-alert show variant="success">
                <div id="buy-gtn">
                    <h5>üí≤–ö—É–ø–∏—Ç—å <b>–≥—É—Å—Ç–∏–Ω–∞–Ω—ã (GTN):</b></h5>
                    <span>
                        –î–ª—è –ø–æ–∫—É–ø–∫–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ
                        <b-link :to="{name: 'payment'}">—Å—é–¥–∞</b-link>
                    </span>
                </div>
            </b-alert>
        </b-card>
    </div>
</template>

<script>
import Loader from "../../components/Loader";
import Chart from "../../components/chart/Chart";
import BalanceWidget from "../../components/wallets/BalanceWidget";
import CurrencyTab from "../../components/currency/CurrencyTab";
import {mapActions, mapGetters} from "vuex";
import Wallet from "../../components/wallets/Wallet";

export default {
    name      : "Bank",
    components: {
        Wallet,
        Chart,
        CurrencyTab,
        BalanceWidget
    },
    data      : () => ({
        loading: true,
        // transaction buttons
        transactionType   : 'buy',
        transactionOptions: [
            {text    : '–ö—É–ø–∏—Ç—å',
                value: 'buy'
            },
            {text    : '–ü—Ä–æ–¥–∞—Ç—å',
                value: 'sell'
            },
        ],

        // chart
        chartData: {},
        options  : {}
    }),
    computed  : {
        ...mapGetters(['getUserWallets', 'getCurrencies']),
    },
    methods   : {
        ...mapActions(['fetchCurrencies'])
    },
    async created() {
        let res = await this.fetchCurrencies();
        if (res) this.loading = false;
        console.log(this.getCurrencies);
    },
    mounted() {
    }
}
</script>

<style scoped lang="scss">
#wallets{
    .container {
        display: grid;
        padding: 0;
        margin: 0 !important;
        grid-template-columns: 1fr 1fr;
        grid-gap: 7px;

        @media (max-width: 630px) {
            grid-template-columns: 1fr;
        }
    }
}
</style>
